---
- hosts: 127.0.0.1
  connection: local
  gather_facts: no
  tasks:
    - name: write inventory config file that uses caching
      copy:
        dest: ../test.aws_ec2.yml
        content: |
          plugin: aws_ec2
          cache: True
          cache_plugin: jsonfile
          cache_connection: aws_ec2_cache_dir
          aws_access_key_id: '{{ aws_access_key }}'
          aws_secret_access_key: '{{ aws_secret_key }}'
          aws_security_token: '{{ security_token }}'
          regions:
            - '{{ aws_region }}'
          filters:
            tag:Name:
              - '{{ resource_prefix }}'
